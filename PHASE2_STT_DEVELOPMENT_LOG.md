# Phase2-2.5 STTå¤šãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ãƒ»VADå¯¾å¿œé–‹ç™ºãƒ­ã‚°

## ğŸ¯ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦

**ç›®æ¨™**: ã€Œã‚¸ãƒ£ãƒ¼ãƒ‹ãƒ¼ã€ã‚¦ã‚§ã‚¤ã‚¯ãƒ¯ãƒ¼ãƒ‰ã§èµ·å‹•ã™ã‚‹å¸¸æ™‚ã‚ªãƒ³ãƒ»ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ éŸ³å£°ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆåŸºç›¤ã®æ§‹ç¯‰  
**ç¾åœ¨ãƒ•ã‚§ãƒ¼ã‚º**: Phase2.5å®Œäº† - VADå¯¾å¿œç™ºè©±åŒºé–“ãƒ™ãƒ¼ã‚¹éŸ³å£°èªè­˜åŸºç›¤ã®å®Œæˆ  
**è¨­è¨ˆåŸå‰‡**: ã‚·ãƒ³ãƒ—ãƒ«ãƒ»ãƒ¢ãƒ€ãƒ³ãƒ»æ‹¡å¼µæ€§ãƒ»å˜ä¸€è²¬ä»»åŸå‰‡ãƒ»å¯èª­æ€§é‡è¦–  
**é–‹ç™ºæŒ‡å‘**: æ®µéšçš„å®Ÿè£…ãƒ»ã‚¯ãƒ­ã‚¹ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ å¯¾å¿œãƒ»ä¸–ç•Œæœ€é«˜å“è³ª  

---

## ğŸ“‹ é–‹ç™ºçµŒç·¯ãƒ»å®Ÿè£…å†…å®¹

### **Phase2é–‹å§‹æ™‚ã®çŠ¶æ³**
- WebSocketçµŒç”±ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ STTã®åŸºæœ¬PoCå®Œæˆ
- OpenAI Whisper-1ã¨ã®é€£æºå‹•ä½œç¢ºèªæ¸ˆã¿
- 3ç§’éŒ²éŸ³ãƒãƒ£ãƒ³ã‚¯æ–¹å¼ã§WebSocketã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ã®æŠ€è¡“çš„èª²é¡Œã‚’è§£æ±º
- AudioStreamTest.jsxã§ç¶™ç¶šçš„éŸ³å£°èªè­˜ãŒå‹•ä½œ

### **Phase2å®Œäº†æ™‚ã®èª²é¡Œèªè­˜**
- OpenAI Whisper-1ã®ã¿ã®å˜ä¸€ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ä¾å­˜
- æ‹¡å¼µæ€§ãƒ»é¸æŠè‚¢ã®ä¸è¶³
- å°†æ¥çš„ãªå¤šãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼å¯¾å¿œã®å¿…è¦æ€§

### **Phase2.5ã§ã®æ–°ãŸãªèª²é¡Œèªè­˜**
- å›ºå®š3ç§’ãƒãƒ£ãƒ³ã‚¯ã«ã‚ˆã‚‹ç™ºè©±é€”ä¸­åˆ‡æ–­å•é¡Œ
- ç„¡éŸ³æ™‚ã®ä¸è¦ãªAPIå‘¼ã³å‡ºã—ï¼ˆ1æ—¥2ä¸‡å›ã®ã‚³ã‚¹ãƒˆå•é¡Œï¼‰
- è‡ªç„¶ãªç™ºè©±åŒºé–“ã§ã®å‡¦ç†ã®å¿…è¦æ€§
- ã‚¯ãƒ­ã‚¹ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ï¼ˆWeb/Mobileï¼‰å¯¾å¿œã®æº–å‚™

---

## ğŸš€ å®Ÿè£…ã—ãŸæ©Ÿèƒ½

## **Phase2: STTå¤šãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼åŸºç›¤**

### **1. STTå¤šãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼æŠ½è±¡åŒ–åŸºç›¤**

#### **çµ±ä¸€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹è¨­è¨ˆ**
**ãƒ•ã‚¡ã‚¤ãƒ«**: `backend/sttProviders/sttInterface.js`

```javascript
class STTProviderInterface {
  async transcribe(audioStream, onResult, onError, options = {}) {
    // éŸ³å£°èªè­˜å®Ÿè¡Œ
  }
  getProviderName() {
    // ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼åå–å¾—
  }
  getSupportedFormats() {
    // ã‚µãƒãƒ¼ãƒˆå½¢å¼ä¸€è¦§
  }
  isAvailable() {
    // åˆ©ç”¨å¯èƒ½æ€§ãƒã‚§ãƒƒã‚¯
  }
}
```

**è¨­è¨ˆæ€æƒ³**: å…¨STTãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ãŒå¾“ã†ã¹ãçµ±ä¸€APIã€å˜ä¸€è²¬ä»»åŸå‰‡ã®å¾¹åº•

#### **STTãƒ•ã‚¡ã‚¯ãƒˆãƒªãƒ¼ï¼ˆãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ç®¡ç†ï¼‰**
**ãƒ•ã‚¡ã‚¤ãƒ«**: `backend/sttProviders/sttFactory.js`

**æ©Ÿèƒ½**:
- ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼å‹•çš„é¸æŠï¼ˆ`openai:whisper-1`, `gemini:gemini-2.5-flash`ï¼‰
- è¨­å®šæ–‡å­—åˆ—ã®è‡ªå‹•ãƒ‘ãƒ¼ã‚¹
- åˆ©ç”¨å¯èƒ½ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ä¸€è¦§å–å¾—
- ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

**ä½¿ç”¨ä¾‹**:
```javascript
const { provider, model, options } = sttFactory.createFromSettings('openai:whisper-1');
provider.transcribe(audioStream, onResult, onError, options);
```

### **2. OpenAI STTãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼**
**ãƒ•ã‚¡ã‚¤ãƒ«**: `backend/sttProviders/openaiSTT.js`

**æ©Ÿèƒ½**:
- æ—¢å­˜ã®openaiRealtimeSTT.jsã‚’çµ±ä¸€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã«æº–æ‹ 
- WebMâ†’WAVå¤‰æ›ï¼ˆffmpegä½¿ç”¨ï¼‰
- OpenAI Whisper-1 APIé€£æº
- ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãƒ»ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯å‡¦ç†

**æŠ€è¡“ä»•æ§˜**:
- ã‚µãƒãƒ¼ãƒˆå½¢å¼: webm, wav, mp3, m4a, flac, ogg
- éŸ³å£°å¤‰æ›: 16kHz, mono, PCM
- API: OpenAI Whisper-1

### **3. Gemini STTãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼**
**ãƒ•ã‚¡ã‚¤ãƒ«**: `backend/sttProviders/geminiSTT.js`

**æ©Ÿèƒ½**:
- Google AI Studio APIï¼ˆGemini 2.5 Flash / 2.0 Flashï¼‰é€£æº
- GoogleAIFileManagerä½¿ç”¨
- WebMâ†’WAVå¤‰æ›å¾Œã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
- æ—¥æœ¬èªéŸ³å£°èªè­˜å¯¾å¿œ

**æŠ€è¡“ä»•æ§˜**:
- ä¾å­˜ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸: `@google/generative-ai`
- ã‚µãƒãƒ¼ãƒˆãƒ¢ãƒ‡ãƒ«: gemini-2.5-flash, gemini-2.0-flash
- éŸ³å£°å½¢å¼: WebM â†’ WAVå¤‰æ›
- ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ: "Generate a transcript of the speech in Japanese."

**å®Ÿè£…è©³ç´°**:
```javascript
// GoogleAIFileManagerã‚’ä½¿ç”¨ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
const uploadResult = await this.fileManager.uploadFile(tmpWav, {
  mimeType: 'audio/wav',
});

// å‹•çš„ãƒ¢ãƒ‡ãƒ«é¸æŠ
const modelName = options.model || 'gemini-2.5-flash';
const model = this.genAI.getGenerativeModel({ model: modelName });
```

### **4. WebSocketã‚µãƒ¼ãƒãƒ¼çµ±åˆ**
**ãƒ•ã‚¡ã‚¤ãƒ«**: `backend/websocketServer.js`

**ä¿®æ­£å†…å®¹**:
- å¤ã„`openaiRealtimeSTT`ã‚¤ãƒ³ãƒãƒ¼ãƒˆã‚’STTãƒ•ã‚¡ã‚¯ãƒˆãƒªãƒ¼ã«ç½®æ›
- ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼é¸æŠãƒ­ã‚¸ãƒƒã‚¯ã®çµ±åˆ
- ä»»æ„ã®`provider:model`å½¢å¼å¯¾å¿œ
- é©åˆ‡ãª`stt_ack`ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é€ä¿¡

**ä¿®æ­£å‰ã®å•é¡Œ**:
```javascript
// å¤ã„å›ºå®šæ¡ä»¶
if (sttMode === 'openai:realtime-stt') {
  // å­˜åœ¨ã—ãªã„ãƒ¢ãƒ‡ãƒ«ã‚’ãƒã‚§ãƒƒã‚¯
}
```

**ä¿®æ­£å¾Œ**:
```javascript
// æ–°ã—ã„å‹•çš„ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼é¸æŠ
const { provider, model, options } = sttFactory.createFromSettings(sttMode);
provider.transcribe(audioStream, onResult, onError, options);
```

### **5. è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«æ‹¡å¼µ**
**ãƒ•ã‚¡ã‚¤ãƒ«**: `backend/config/models.json`

**è¿½åŠ å†…å®¹**:
```json
{
  "gemini": {
    "default": "gemini-2.5-flash",
    "candidates": [
      { "name": "gemini-2.5-flash", "tags": ["stt"] },
      { "name": "gemini-2.0-flash", "tags": ["stt"] },
      { "name": "gemini-pro", "tags": ["dialog", "research"] }
    ]
  }
}
```

**è¨­è¨ˆæ–¹é‡**: Azureé–¢é€£ã¯é™¤å¤–ã€OpenAIãƒ»Geminiãƒ»Googleã«é›†ä¸­

---

## ğŸ”§ æŠ€è¡“çš„è§£æ±ºäº‹é …

### **å•é¡Œ1: WebSocketã‚µãƒ¼ãƒãƒ¼ã®STTé–‹å§‹ãƒ­ã‚¸ãƒƒã‚¯**
**ç—‡çŠ¶**: `stt_ack`ãŒé€ä¿¡ã•ã‚Œãšã€ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãŒæ¬¡ã«é€²ã‚ãªã„  
**åŸå› **: å¤ã„`openai:realtime-stt`å½¢å¼ã®æ¡ä»¶åˆ†å²  
**è§£æ±º**: STTãƒ•ã‚¡ã‚¯ãƒˆãƒªãƒ¼ã«ã‚ˆã‚‹å‹•çš„ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼æ¤œè¨¼ãƒ»é©åˆ‡ãªACKé€ä¿¡  

### **å•é¡Œ2: Gemini APIé€£æºã‚¨ãƒ©ãƒ¼**
**ç—‡çŠ¶**: `this.genAI.uploadFile is not a function`  
**åŸå› **: `GoogleAIFileManager`ã®ä¸é©åˆ‡ãªã‚¤ãƒ³ãƒãƒ¼ãƒˆ  
**è§£æ±º**: `@google/generative-ai/server`ã‹ã‚‰æ­£ã—ãã‚¤ãƒ³ãƒãƒ¼ãƒˆ  

### **å•é¡Œ3: å¾Œæ–¹äº’æ›æ€§ã®è¤‡é›‘åŒ–**
**ãƒ¦ãƒ¼ã‚¶ãƒ¼æ–¹é‡**: å¾Œæ–¹äº’æ›æ€§ç¦æ­¢ã€ã‚¯ãƒªãƒ¼ãƒ³ãªè¨­è¨ˆå„ªå…ˆ  
**å¯¾å¿œ**: è‡ªå‹•å¤‰æ›ãƒ­ã‚¸ãƒƒã‚¯ã‚’å‰Šé™¤ã€ç´”ç²‹ãª`provider:model`å½¢å¼ã®ã¿ã‚µãƒãƒ¼ãƒˆ  

---

## ğŸ“Š å‹•ä½œç¢ºèªçµæœ

### **OpenAI STTãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼**
âœ… **æ­£å¸¸å‹•ä½œç¢ºèªæ¸ˆã¿**  
- è¨­å®š: `openai:whisper-1`
- WebMâ†’WAVå¤‰æ›: æˆåŠŸ
- éŸ³å£°èªè­˜: æ—¥æœ¬èªèªè­˜æ­£å¸¸
- ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°: é©åˆ‡

### **Gemini STTãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼**
âœ… **æ­£å¸¸å‹•ä½œç¢ºèªæ¸ˆã¿**  
- è¨­å®š: `gemini:gemini-2.0-flash`, `gemini:gemini-2.5-flash`
- ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰: æˆåŠŸ
- éŸ³å£°èªè­˜: æ—¥æœ¬èªèªè­˜æ­£å¸¸
- ãƒ¢ãƒ‡ãƒ«åˆ‡æ›¿: å‹•çš„é¸æŠæ©Ÿèƒ½

### **ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼åˆ‡æ›¿**
âœ… **è¨­å®šç”»é¢ã‹ã‚‰ã®å‹•çš„åˆ‡æ›¿ç¢ºèªæ¸ˆã¿**  
- OpenAI â‡” Geminié–“ã®åˆ‡æ›¿
- WebSocketã‚µãƒ¼ãƒãƒ¼ã§ã®é©åˆ‡ãªå‡¦ç†åˆ†å²
- ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

---

## ğŸ—ï¸ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è¨­è¨ˆ

### **ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ **
```
backend/
â”œâ”€â”€ sttProviders/
â”‚   â”œâ”€â”€ sttInterface.js      # çµ±ä¸€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
â”‚   â”œâ”€â”€ openaiSTT.js        # OpenAI Whisper-1ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼
â”‚   â”œâ”€â”€ geminiSTT.js        # Gemini STTãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼
â”‚   â””â”€â”€ sttFactory.js       # ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ç®¡ç†ãƒ»é¸æŠ
â”œâ”€â”€ websocketServer.js       # WebSocketçµ±åˆ
â””â”€â”€ config/models.json       # ãƒ¢ãƒ‡ãƒ«è¨­å®š
```

### **ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼**
```
AudioStreamTest.jsx
  â†“ WebSocket
websocketServer.js
  â†“ STTFactory
sttProviders/[provider].js
  â†“ APIå‘¼ã³å‡ºã—
OpenAI/Gemini API
  â†“ èªè­˜çµæœ
ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰è¡¨ç¤º
```

---

## ğŸ¯ æ¬¡æœŸé–‹ç™ºæ–¹é‡

### **Phase 2.5: æ–‡è„ˆç†è§£ãƒ»ã‚­ãƒ£ãƒ³ãƒã‚¹ã‚·ã‚¹ãƒ†ãƒ **

#### **æ–°ã—ã„ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è¨­è¨ˆ**
**ã‚³ãƒ³ã‚»ãƒ—ãƒˆ**: å¸¸æ™‚STTéŒ²éŸ³ + éåŒæœŸå‡¦ç† + ã‚­ãƒ£ãƒ³ãƒã‚¹å‡ºåŠ›

**åˆ©ç”¨ãƒ•ãƒ­ãƒ¼**:
```
ğŸ‘¤ ãƒ¦ãƒ¼ã‚¶ãƒ¼: "ä»Šæ—¥ã®å¤©æ°—ãªã‚“ã ã£ã‘"
ğŸ¤ [3ç§’éŸ³å£°] â†’ STT â†’ "ä»Šæ—¥ã®å¤©æ°—ãªã‚“ã ã£ã‘"
ğŸ§  æ–‡è„ˆè“„ç©: ["ä»Šæ—¥ã®å¤©æ°—ã‚’çŸ¥ã‚ŠãŸã„"]
âš¡ éåŒæœŸå‡¦ç†é–‹å§‹ â†’ å¤©æ°—APIå‘¼ã³å‡ºã—
ğŸ‘¤ ãƒ¦ãƒ¼ã‚¶ãƒ¼: "æ˜æ—¥ã®äºˆå®šä½•ã‹ã‚ã£ãŸã£ã‘ãª"
ğŸ¤ [3ç§’éŸ³å£°] â†’ STT â†’ "æ˜æ—¥ã®äºˆå®šãªã‚“ã ï¼Ÿ"  
ğŸ§  æ–‡è„ˆæ›´æ–°: ["ä»Šæ—¥ã®å¤©æ°—ã‚’æ•™ãˆã¦", "ãã‚Œã¨æ˜æ—¥ã®äºˆå®šã‚‚"]
âš¡ éåŒæœŸå‡¦ç†: å¤©æ°— + ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼APIä¸¦è¡Œå®Ÿè¡Œ
ğŸ“‹ ã‚­ãƒ£ãƒ³ãƒã‚¹ã«å¤©æ°—ã¨äºˆå®šè¡¨ç¤º
```

#### **ã‚­ãƒ¼ãƒã‚¤ãƒ³ãƒˆ**:
- **éŸ³å£°å‡ºåŠ›ä¸è¦**: å…¨ã¦ã€Œã‚­ãƒ£ãƒ³ãƒã‚¹ã€UIã«è¡¨ç¤º
- **å¸¸æ™‚éŒ²éŸ³**: STTã§ç¶™ç¶šçš„ã«éŸ³å£°èªè­˜
- **éåŒæœŸå‡¦ç†**: è¤‡æ•°APIä¸¦è¡Œå®Ÿè¡Œ
- **æ–‡è„ˆè“„ç©**: åˆ†å‰²éŸ³å£°ã‹ã‚‰æ„å›³æŠ½å‡º

#### **å®Ÿè£…äºˆå®šã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ**:
1. **VoiceCanvas UI** - æƒ…å ±é›†ç´„è¡¨ç¤ºç”»é¢
2. **ContinuousVoiceProcessor** - å¸¸æ™‚æ–‡è„ˆç®¡ç†
3. **IntentProcessor** - è‡ªç„¶è¨€èªâ†’APIå‘¼ã³å‡ºã—
4. **CanvasManager** - WebSocketçµŒç”±ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°

### **Phase 3: VADãƒ»ã‚¦ã‚§ã‚¤ã‚¯ãƒ¯ãƒ¼ãƒ‰æ¤œå‡º**
- **ã€Œã‚¸ãƒ£ãƒ¼ãƒ‹ãƒ¼ã€ã‚¦ã‚§ã‚¤ã‚¯ãƒ¯ãƒ¼ãƒ‰** â†’ åŒæœŸå‡¦ç†ãƒ¢ãƒ¼ãƒ‰
- **Voice Activity Detection** â†’ è‡ªç„¶ãªç™ºè©±åŒºé–“æ¤œå‡º
- **å‡¦ç†ãƒ¢ãƒ¼ãƒ‰åˆ‡æ›¿** â†’ éåŒæœŸâ‡”åŒæœŸã®é©åˆ‡ãªåˆ¶å¾¡

---

## ğŸ› ï¸ é–‹ç™ºç’°å¢ƒãƒ»ä¾å­˜é–¢ä¿‚

### **ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ä¾å­˜ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸**
```json
{
  "openai": "^4.x.x",
  "@google/generative-ai": "^0.x.x",
  "ws": "^8.x.x"
}
```

### **ç’°å¢ƒå¤‰æ•°**
```bash
# backend/.env
OPENAI_API_KEY=sk-proj-...
GEMINI_API_KEY=AIzaSy...
```

### **å¤–éƒ¨ãƒ„ãƒ¼ãƒ«**
- **ffmpeg**: éŸ³å£°å½¢å¼å¤‰æ›ï¼ˆWebMâ†’WAVï¼‰
- **Node.js**: v18+æ¨å¥¨

---

## ğŸ“ é–‹ç™ºãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

### **è¨­è¨ˆåŸå‰‡ã®å®Ÿè·µ**
1. **ã‚·ãƒ³ãƒ—ãƒ«**: çµ±ä¸€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã§è¤‡é›‘ã•ã‚’éš è”½
2. **ãƒ¢ãƒ€ãƒ³**: æœ€æ–°APIãƒ»SDKä½¿ç”¨
3. **æ‹¡å¼µæ€§**: æ–°ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼è¿½åŠ ãŒå®¹æ˜“
4. **å˜ä¸€è²¬ä»»**: å„ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ãŒç‹¬ç«‹
5. **å¯èª­æ€§**: ã‚¯ãƒªãƒ¼ãƒ³ãªã‚³ãƒ¼ãƒ‰æ§‹é€ 

### **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°**
- å„æ®µéšã§ã®é©åˆ‡ãªtry-catch
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ãƒ¬ãƒ³ãƒ‰ãƒªãƒ¼ãªã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
- ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯å‡¦ç†ï¼ˆffmpegå¤±æ•—æ™‚ç­‰ï¼‰

### **ãƒ†ã‚¹ãƒˆæ–¹æ³•**
1. è¨­å®šç”»é¢ã§ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼é¸æŠ
2. AudioStreamTestã§éŸ³å£°èªè­˜ãƒ†ã‚¹ãƒˆ
3. WebSocketãƒ­ã‚°ã§ãƒ‡ãƒãƒƒã‚°ç¢ºèª
4. è¤‡æ•°ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼é–“ã®åˆ‡æ›¿ãƒ†ã‚¹ãƒˆ

---

## ğŸ‰ é”æˆã—ãŸæˆæœ

### **æŠ€è¡“çš„æˆæœ**
âœ… **STTå¤šãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼åŸºç›¤** - å®Œå…¨å®Ÿè£…ãƒ»å‹•ä½œç¢ºèªæ¸ˆã¿  
âœ… **çµ±ä¸€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹** - æ‹¡å¼µæ€§ãƒ»ä¿å®ˆæ€§å‘ä¸Š  
âœ… **OpenAIãƒ»Geminiä¸¡å¯¾å¿œ** - é¸æŠè‚¢ã®å¤šæ§˜åŒ–  
âœ… **WebSocketçµ±åˆ** - ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ åˆ‡æ›¿æ©Ÿèƒ½  
âœ… **è¨­å®šç”»é¢é€£æº** - ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ãƒ¬ãƒ³ãƒ‰ãƒªãƒ¼ãªæ“ä½œ  

### **è¨­è¨ˆå“è³ª**
âœ… **å˜ä¸€è²¬ä»»åŸå‰‡** - å„ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒç‹¬ç«‹  
âœ… **æ‹¡å¼µæ€§** - æ–°ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼è¿½åŠ ãŒå®¹æ˜“  
âœ… **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°** - å …ç‰¢ãªä¾‹å¤–å‡¦ç†  
âœ… **ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆåŒ–** - ç¬¬ä¸‰è€…å¼•ç¶™ãå¯èƒ½  

---

## ğŸš€ æ¬¡ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚¢ã‚¤ãƒ†ãƒ 

### **å³åº§ã«ç€æ‰‹å¯èƒ½**
1. **VoiceCanvas UIå®Ÿè£…** - åŸºæœ¬çš„ãªæƒ…å ±è¡¨ç¤ºç”»é¢
2. **æ–‡è„ˆè“„ç©ã‚·ã‚¹ãƒ†ãƒ ** - STTçµæœã®ç¶™ç¶šç®¡ç†
3. **ç°¡å˜ãªæ„å›³è§£æ** - å¤©æ°—ãƒ»äºˆå®šãªã©ã®åŸºæœ¬æ©Ÿèƒ½

### **ä¸­æœŸç›®æ¨™**
1. **éåŒæœŸAPIå‡¦ç†åŸºç›¤** - è¤‡æ•°ã‚µãƒ¼ãƒ“ã‚¹ä¸¦è¡Œå®Ÿè¡Œ
2. **ã‚­ãƒ£ãƒ³ãƒã‚¹ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ** - WebSocketçµŒç”±æ›´æ–°
3. **ã‚¦ã‚§ã‚¤ã‚¯ãƒ¯ãƒ¼ãƒ‰æ¤œå‡ºæº–å‚™** - VADåŸºç›¤è¨­è¨ˆ

### **é•·æœŸãƒ“ã‚¸ãƒ§ãƒ³**
1. **ã€Œã‚¸ãƒ£ãƒ¼ãƒ‹ãƒ¼ã€ã‚¦ã‚§ã‚¤ã‚¯ãƒ¯ãƒ¼ãƒ‰** - åŒæœŸå‡¦ç†ãƒ¢ãƒ¼ãƒ‰
2. **å®Œå…¨ãªéŸ³å£°ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ** - è‡ªç„¶ãªå¯¾è©±ãƒ•ãƒ­ãƒ¼
3. **ä¸–ç•Œæœ€é«˜ã®ãƒ—ãƒ­ãƒ€ã‚¯ãƒˆ** - å®Ÿç”¨æ€§ãƒ»æ‹¡å¼µæ€§ã®ä¸¡ç«‹

---

## ğŸ“ å¼•ç¶™ãæƒ…å ±

### **é‡è¦ãƒ•ã‚¡ã‚¤ãƒ«**
- `backend/sttProviders/` - STTå¤šãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼åŸºç›¤
- `backend/websocketServer.js` - WebSocketçµ±åˆ
- `backend/config/models.json` - ãƒ¢ãƒ‡ãƒ«è¨­å®š
- `apps/web/src/AudioStreamTest.jsx` - ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒ†ã‚¹ãƒˆ

### **ãƒ†ã‚¹ãƒˆæ‰‹é †**
1. ç’°å¢ƒå¤‰æ•°è¨­å®šï¼ˆOpenAIãƒ»Gemini APIã‚­ãƒ¼ï¼‰
2. ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚µãƒ¼ãƒãƒ¼èµ·å‹•
3. ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰èµ·å‹•
4. AudioStreamTestã§ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼åˆ‡æ›¿ãƒ†ã‚¹ãƒˆ

### **ãƒ‡ãƒãƒƒã‚°ãƒã‚¤ãƒ³ãƒˆ**
- WebSocketã‚µãƒ¼ãƒãƒ¼ãƒ­ã‚°ç¢ºèª
- STTãƒ•ã‚¡ã‚¯ãƒˆãƒªãƒ¼ã®ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼é¸æŠ
- éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«å¤‰æ›ï¼ˆffmpegï¼‰
- APIå‘¼ã³å‡ºã—çµæœ

---

## **Phase2.5: VADå¯¾å¿œç™ºè©±åŒºé–“ãƒ™ãƒ¼ã‚¹éŸ³å£°å‡¦ç†**

---

### ã€é€²æ—ã‚µãƒãƒªãƒ¼ãƒ»2025-07-21ã€‘

- Phase2.5ï¼ˆVADProcessorãƒ»AudioStreamTestæ”¹è‰¯ãƒ»WebSocketã‚µãƒ¼ãƒãƒ¼æ‹¡å¼µãƒ»ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ æŠ½è±¡åŒ–ï¼‰ã¯å®Œå…¨ã«å®Œäº†ã€‚
- å›ºå®š3ç§’ãƒãƒ£ãƒ³ã‚¯ã‹ã‚‰è‡ªç„¶ãªç™ºè©±åŒºé–“ãƒ™ãƒ¼ã‚¹å‡¦ç†ã¸ç§»è¡Œã—ã€APIå‘¼ã³å‡ºã—å›æ•°ãƒ»ã‚³ã‚¹ãƒˆãƒ»èªè­˜ç²¾åº¦ãŒå¤§å¹…å‘ä¸Šã€‚
- ã‚¯ãƒ­ã‚¹ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ï¼ˆWeb/Mobileï¼‰å¯¾å¿œã®è¨­è¨ˆã¨å®Ÿè£…ã‚‚å®Œäº†ã—ã€ä»Šå¾Œã®ãƒ¢ãƒã‚¤ãƒ«å±•é–‹æº–å‚™ã‚‚æ•´ã£ãŸã€‚
- éŸ³é‡é–¾å€¤ãªã©ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿èª¿æ•´ã‚‚æŸ”è»Ÿã«å¯èƒ½ã€‚
- é–‹ç™ºãƒ­ã‚°ãƒ»è¨­è¨ˆãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚‚æœ€æ–°åŒ–æ¸ˆã¿ã€‚

---

### ã€æ¬¡ã®é¸æŠè‚¢ãƒ»å„ªå…ˆåº¦ã€‘

1. **éåŒæœŸãƒ»åŒæœŸå‡¦ç†ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³è¨­è¨ˆï¼ˆPhase3ï¼‰**
   - éåŒæœŸï¼ˆãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰å‡¦ç†ï¼‰ã¨åŒæœŸï¼ˆã‚¦ã‚§ã‚¤ã‚¯ãƒ¯ãƒ¼ãƒ‰ã€Œã‚¸ãƒ£ãƒ¼ãƒ‹ãƒ¼ã€æ¤œå‡ºæ™‚ã®å°‚ç”¨å¯¾è©±ï¼‰ã‚’åˆ†é›¢ã™ã‚‹ãƒ‘ã‚¤ãƒ—è¨­è¨ˆ
   - å‡ºåŠ›ãƒ‘ã‚¤ãƒ—ã®åˆ‡æ›¿è¨­è¨ˆãƒ»å®Ÿè£…
   - ã‚¦ã‚§ã‚¤ã‚¯ãƒ¯ãƒ¼ãƒ‰æ¤œå‡ºã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®å…·ä½“åŒ–
2. **VoiceCanvas UIã®è¨­è¨ˆãƒ»å®Ÿè£…**
   - ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ èªè­˜çµæœã‚„ã‚·ã‚¹ãƒ†ãƒ çŠ¶æ…‹ã‚’å¯è¦–åŒ–ã™ã‚‹UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
   - WebSocketå‡ºåŠ›ã¨ã®é€£æº
3. **ãƒ¢ãƒã‚¤ãƒ«ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ å¯¾å¿œå¼·åŒ–**
   - MobileAudioPlatformã®æœ¬æ ¼å®Ÿè£…ï¼ˆReact Native/Expoï¼‰
   - ãƒã‚¤ãƒ†ã‚£ãƒ–APIã«æœ€é©åŒ–ã—ãŸVADãƒ»éŒ²éŸ³å‡¦ç†
4. **æ–‡è„ˆç®¡ç†ãƒ»è‡ªå‹•ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—**
   - VoiceSessionManagerã«ã‚ˆã‚‹5åˆ†è‡ªå‹•ç ´æ£„ãƒ»ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ä¿è­·
5. **ãã®ä»–ï¼šè¨­è¨ˆåŸå‰‡ãƒ»å“è³ªå‘ä¸Š**
   - ã‚·ãƒ³ãƒ—ãƒ«ãƒ»ãƒ¢ãƒ€ãƒ³ãƒ»æ‹¡å¼µæ€§ãƒ»å˜ä¸€è²¬ä»»åŸå‰‡ã®å³å®ˆ

---

â€»å„ªå…ˆé †ä½ã‚„è¿½åŠ è¦ä»¶ã¯éšæ™‚è¦‹ç›´ã—ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼è¦æœ›ãƒ»å®Ÿé‹ç”¨ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’ã‚‚ã¨ã«æœ€é©åŒ–ã—ã¦ã„ãã€‚

---


### **ğŸ¯ Phase2.5ã®ç›®æ¨™**
- å›ºå®š3ç§’ãƒãƒ£ãƒ³ã‚¯ã‹ã‚‰è‡ªç„¶ãªç™ºè©±åŒºé–“ãƒ™ãƒ¼ã‚¹å‡¦ç†ã¸ã®ç§»è¡Œ
- Voice Activity Detection (VAD) ã«ã‚ˆã‚‹åŠ¹ç‡çš„ãªéŸ³å£°å‡¦ç†
- ã‚¯ãƒ­ã‚¹ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ å¯¾å¿œè¨­è¨ˆï¼ˆWeb/Mobileçµ±ä¸€ï¼‰
- APIå‘¼ã³å‡ºã—å‰Šæ¸›ã¨ã‚³ã‚¹ãƒˆæœ€é©åŒ–

### **ğŸ”§ æ–°è¦å®Ÿè£…ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ**

#### **1. VADProcessor - éŸ³é‡ãƒ™ãƒ¼ã‚¹ç™ºè©±åŒºé–“æ¤œå‡º**
**ãƒ•ã‚¡ã‚¤ãƒ«**: `apps/web/src/audio/VADProcessor.js`

**æ©Ÿèƒ½**:
- **éŸ³é‡ãƒ™ãƒ¼ã‚¹VAD**: Web Audio APIã‚’æ´»ç”¨ã—ãŸãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ éŸ³é‡åˆ†æ
- **èª¿æ•´å¯èƒ½ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿**: éŸ³é‡é–¾å€¤ã€ç™ºè©±é–‹å§‹/çµ‚äº†é…å»¶ã€æœ€å°/æœ€å¤§ç™ºè©±æ™‚é–“
- **ã‚¤ãƒ™ãƒ³ãƒˆé§†å‹•**: ç™ºè©±é–‹å§‹/çµ‚äº†ã®è‡ªå‹•æ¤œå‡ºã¨ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯
- **ãƒ‡ãƒãƒƒã‚°æ©Ÿèƒ½**: è©³ç´°ãƒ­ã‚°å‡ºåŠ›ã¨ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ çŠ¶æ…‹ç›£è¦–

**æŠ€è¡“ä»•æ§˜**:
```javascript
class VADProcessor {
  constructor(options = {
    volumeThreshold: 0.08,      // éŸ³é‡é–¾å€¤ï¼ˆ0-1ï¼‰
    speechStartDelay: 150,      // ç™ºè©±é–‹å§‹åˆ¤å®šæ™‚é–“ï¼ˆmsï¼‰
    speechEndDelay: 1000,       // ç™ºè©±çµ‚äº†åˆ¤å®šæ™‚é–“ï¼ˆmsï¼‰
    minSpeechDuration: 800,     // æœ€å°ç™ºè©±æ™‚é–“ï¼ˆmsï¼‰
    maxSpeechDuration: 30000,   // æœ€å¤§ç™ºè©±æ™‚é–“ï¼ˆmsï¼‰
    debug: true                 // ãƒ‡ãƒãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰
  })
}
```

**è¨­è¨ˆæ€æƒ³**: å˜ä¸€è²¬ä»»åŸå‰‡ï¼ˆVADæ¤œå‡ºã®ã¿ï¼‰ã€ãƒ¢ãƒ€ãƒ³æŠ€è¡“æ´»ç”¨ã€æ‹¡å¼µæ€§é‡è¦–

#### **2. AudioStreamTestæ”¹è‰¯ - VADåˆ¶å¾¡å¯¾å¿œ**
**ãƒ•ã‚¡ã‚¤ãƒ«**: `apps/web/src/AudioStreamTest.jsx`

**æ”¹è‰¯å†…å®¹**:
- **å›ºå®šã‚¿ã‚¤ãƒãƒ¼å»ƒæ­¢**: 3ç§’å›ºå®š â†’ VADåˆ¶å¾¡ã«ã‚ˆã‚‹è‡ªç„¶ãªç™ºè©±åŒºé–“
- **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ çŠ¶æ…‹è¡¨ç¤º**: éŸ³é‡ãƒ¬ãƒ™ãƒ«ã€ç™ºè©±çŠ¶æ…‹ã®å¯è¦–åŒ–
- **ç™ºè©±åŒºé–“ãƒ™ãƒ¼ã‚¹é€ä¿¡**: å®Œå…¨ãªç™ºè©±ã®ã¿ã‚’WebSocketã§é€ä¿¡
- **ãƒ¦ãƒ¼ã‚¶ãƒ“ãƒªãƒ†ã‚£å‘ä¸Š**: è¦–è¦šçš„ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã¨ç›´æ„Ÿçš„æ“ä½œ

**æŠ€è¡“çš„æ”¹å–„**:
```javascript
// æ—§: å›ºå®š3ç§’ã‚¿ã‚¤ãƒãƒ¼
setTimeout(() => mediaRecorder.stop(), 3000);

// æ–°: VADåˆ¶å¾¡
vadProcessor.onSpeechStart = () => startSpeechRecording();
vadProcessor.onSpeechEnd = () => stopSpeechRecording();
```

#### **3. WebSocketã‚µãƒ¼ãƒãƒ¼æ‹¡å¼µ - ç™ºè©±åŒºé–“ãƒ™ãƒ¼ã‚¹å‡¦ç†**
**ãƒ•ã‚¡ã‚¤ãƒ«**: `backend/websocketServer.js`

**æ‹¡å¼µå†…å®¹**:
- **å³åº§å‡¦ç†**: VADã§åŒºåˆ‡ã‚‰ã‚ŒãŸå®Œå…¨ãªç™ºè©±ã‚’å³åº§ã«STTå‡¦ç†
- **ãƒãƒƒãƒ•ã‚¡ç®¡ç†**: ç™ºè©±åŒºé–“ã”ã¨ã®åŠ¹ç‡çš„ãªãƒ‡ãƒ¼ã‚¿ç®¡ç†
- **è©³ç´°ãƒ­ã‚°**: ã‚»ã‚°ãƒ¡ãƒ³ãƒˆã‚µã‚¤ã‚ºã€ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ä»˜ããƒ¬ã‚¹ãƒãƒ³ã‚¹
- **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°**: å …ç‰¢ãªä¾‹å¤–å‡¦ç†ã¨ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—

**å‡¦ç†ãƒ•ãƒ­ãƒ¼**:
```javascript
// ç™ºè©±åŒºé–“ãƒ‡ãƒ¼ã‚¿å—ä¿¡ â†’ å³åº§ã«STTå‡¦ç†
speechSegmentBuffer.push(Buffer.from(data));
const speechSegment = Buffer.concat(speechSegmentBuffer);
provider.transcribe(speechSegment, onResult, onError, options);
```

#### **4. ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ æŠ½è±¡åŒ– - Web/Mobileå¯¾å¿œè¨­è¨ˆ**
**ãƒ•ã‚¡ã‚¤ãƒ«**: `apps/web/src/audio/AudioPlatformAdapter.js`

**æ©Ÿèƒ½**:
- **çµ±ä¸€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹**: å…¨ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ å…±é€šAPI
- **WebAudioPlatform**: ç¾åœ¨ã®Webç’°å¢ƒå®Œå…¨å¯¾å¿œ
- **MobileAudioPlatform**: å°†æ¥ã®React Nativeå¯¾å¿œæº–å‚™
- **UnifiedAudioManager**: é«˜ãƒ¬ãƒ™ãƒ«çµ±åˆAPI

**è¨­è¨ˆãƒ‘ã‚¿ãƒ¼ãƒ³**:
```javascript
// ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ è‡ªå‹•æ¤œå‡º
const platform = AudioPlatformFactory.create();

// çµ±ä¸€APIä½¿ç”¨
const audioManager = new UnifiedAudioManager();
await audioManager.start(vadOptions, streamConstraints);
```

### **ğŸ“Š Phase2.5ã®æˆæœ**

#### **åŠ¹ç‡åŒ–**
âœ… **APIå‘¼ã³å‡ºã—å‰Šæ¸›**: ç„¡éŸ³æ™‚ã¯é€ä¿¡åœæ­¢ï¼ˆ1æ—¥2ä¸‡å› â†’ å®Ÿéš›ã®ç™ºè©±å›æ•°ã®ã¿ï¼‰  
âœ… **è‡ªç„¶ãªåŒºåˆ‡ã‚Š**: ç™ºè©±é€”ä¸­ã§åˆ‡æ–­ã•ã‚Œãªã„å®Œå…¨ãªéŸ³å£°èªè­˜  
âœ… **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ å‡¦ç†**: ç™ºè©±çµ‚äº†ã¨åŒæ™‚ã«STTé–‹å§‹  

#### **æ‹¡å¼µæ€§**
âœ… **ã‚¯ãƒ­ã‚¹ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ **: Web/Mobileçµ±ä¸€è¨­è¨ˆ  
âœ… **ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿èª¿æ•´**: ç’°å¢ƒã«å¿œã˜ãŸVADæœ€é©åŒ–  
âœ… **ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼å¯¾å¿œ**: æ—¢å­˜STTå¤šãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼åŸºç›¤æ´»ç”¨  

#### **ãƒ¦ãƒ¼ã‚¶ãƒ“ãƒªãƒ†ã‚£**
âœ… **è¦–è¦šçš„ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯**: éŸ³é‡ãƒ¬ãƒ™ãƒ«ã€ç™ºè©±çŠ¶æ…‹è¡¨ç¤º  
âœ… **è‡ªç„¶ãªæ“ä½œ**: è©±ã™ã ã‘ã§è‡ªå‹•éŒ²éŸ³ãƒ»èªè­˜  
âœ… **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°**: å …ç‰¢ãªä¾‹å¤–å‡¦ç†  

### **ğŸ”„ é–‹ç™ºãƒ—ãƒ­ã‚»ã‚¹ãƒ»æŒ‡å‘**

#### **æ®µéšçš„å®Ÿè£…ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ**
1. **æ—¢å­˜ã‚³ãƒ¼ãƒ‰èª¿æŸ»** â†’ ç¾çŠ¶æŠŠæ¡ã¨æœ€é©çµ±åˆãƒã‚¤ãƒ³ãƒˆç‰¹å®š
2. **VADProcessorä½œæˆ** â†’ éŸ³é‡ãƒ™ãƒ¼ã‚¹ + èª¿æ•´å¯èƒ½ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
3. **AudioStreamTestæ”¹è‰¯** â†’ å›ºå®šã‚¿ã‚¤ãƒãƒ¼ â†’ VADåˆ¶å¾¡
4. **WebSocketã‚µãƒ¼ãƒãƒ¼æ‹¡å¼µ** â†’ ç™ºè©±åŒºé–“ãƒ™ãƒ¼ã‚¹å‡¦ç†
5. **ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ æŠ½è±¡åŒ–** â†’ Web/Mobileå¯¾å¿œã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹

#### **è¨­è¨ˆåŸå‰‡ã®å®Ÿè·µ**
- **ã‚·ãƒ³ãƒ—ãƒ«**: çµ±ä¸€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã§è¤‡é›‘ã•ã‚’éš è”½
- **ãƒ¢ãƒ€ãƒ³**: Web Audio APIã€æœ€æ–°JavaScriptæ©Ÿèƒ½æ´»ç”¨
- **æ‹¡å¼µæ€§**: æ–°ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ãƒ»ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼è¿½åŠ ãŒå®¹æ˜“
- **å˜ä¸€è²¬ä»»**: å„ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒç‹¬ç«‹ã—ãŸæ˜ç¢ºãªè²¬ä»»
- **å¯èª­æ€§**: ã‚¯ãƒªãƒ¼ãƒ³ãªã‚³ãƒ¼ãƒ‰æ§‹é€ ã¨ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆåŒ–

#### **ä¸–ç•Œæœ€é«˜å“è³ªã¸ã®å–ã‚Šçµ„ã¿**
- **ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸­å¿ƒè¨­è¨ˆ**: å®Ÿéš›ã®ä½¿ç”¨æ„Ÿã‚’é‡è¦–ã—ãŸèª¿æ•´ï¼ˆéŸ³é‡é–¾å€¤0.08ç­‰ï¼‰
- **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–**: ä¸è¦ãªå‡¦ç†å‰Šæ¸›ã¨ãƒªã‚½ãƒ¼ã‚¹åŠ¹ç‡åŒ–
- **å …ç‰¢æ€§**: åŒ…æ‹¬çš„ãªã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã¨ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯
- **å°†æ¥æ€§**: ãƒ¢ãƒã‚¤ãƒ«å±•é–‹ã‚’è¦‹æ®ãˆãŸè¨­è¨ˆ

---

## ğŸš€ æ¬¡ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚¢ã‚¤ãƒ†ãƒ ï¼ˆPhase3æº–å‚™ï¼‰

### **å³åº§ã«ç€æ‰‹å¯èƒ½**
1. **éåŒæœŸå‡¦ç†ãƒ‘ã‚¤ãƒ—å®Ÿè£…** - ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã§ã®ãƒ„ãƒ¼ãƒ«å‘¼ã³å‡ºã—æ¤œå‡º
2. **åŒæœŸå‡¦ç†ãƒ‘ã‚¤ãƒ—å®Ÿè£…** - ã‚¦ã‚§ã‚¤ã‚¯ãƒ¯ãƒ¼ãƒ‰ã€Œã‚¸ãƒ£ãƒ¼ãƒ‹ãƒ¼ã€æ¤œå‡ºæº–å‚™
3. **VoiceCanvas UIè¨­è¨ˆ** - æƒ…å ±é›†ç´„è¡¨ç¤ºã‚·ã‚¹ãƒ†ãƒ 

### **ä¸­æœŸç›®æ¨™ï¼ˆPhase3ï¼‰**
1. **ã‚¦ã‚§ã‚¤ã‚¯ãƒ¯ãƒ¼ãƒ‰æ¤œå‡º** - ã€Œã‚¸ãƒ£ãƒ¼ãƒ‹ãƒ¼ã€ã«ã‚ˆã‚‹åŒæœŸãƒ¢ãƒ¼ãƒ‰èµ·å‹•
2. **å‡ºåŠ›ãƒ‘ã‚¤ãƒ—åˆ†é›¢** - éåŒæœŸãƒ»åŒæœŸå‡¦ç†ã®é©åˆ‡ãªåˆ¶å¾¡
3. **ã‚­ãƒ£ãƒ³ãƒã‚¹ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ** - WebSocketçµŒç”±ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°

### **é•·æœŸãƒ“ã‚¸ãƒ§ãƒ³ï¼ˆPhase4ï¼‰**
1. **å®Œå…¨ãªéŸ³å£°ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ** - å¸¸æ™‚ã‚ªãƒ³ãƒ»è‡ªç„¶ãªå¯¾è©±ãƒ•ãƒ­ãƒ¼
2. **ãƒ¢ãƒã‚¤ãƒ«ã‚¢ãƒ—ãƒªå±•é–‹** - React Nativeå®Ÿè£…
3. **ä¸–ç•Œæœ€é«˜ã®ãƒ—ãƒ­ãƒ€ã‚¯ãƒˆ** - å®Ÿç”¨æ€§ãƒ»æ‹¡å¼µæ€§ãƒ»å“è³ªã®å®Œå…¨ãªä¸¡ç«‹

**Phase2.5ã®å …å®ŸãªåŸºç›¤ã‚’æ´»ç”¨ã—ã¦ã€Phase3ã®ã‚¦ã‚§ã‚¤ã‚¯ãƒ¯ãƒ¼ãƒ‰æ¤œå‡ºãƒ»å‡ºåŠ›ãƒ‘ã‚¤ãƒ—åˆ†é›¢ã‚·ã‚¹ãƒ†ãƒ å®Ÿè£…ã«é€²ã‚€ã“ã¨ã‚’æ¨å¥¨ã—ã¾ã™ã€‚**

---

## **Phase2.5+ Journey Room UIçµ±åˆãƒ»ãƒ‡ãƒãƒƒã‚°å®Œäº†ï¼ˆ2025-01-22ï¼‰**

### **ğŸ¯ å®Ÿè£…æ¦‚è¦**

**ç›®æ¨™**: VoiceCanvasã‚’ã€ŒJourney Roomã€ã«ãƒªãƒãƒ¼ãƒ ã—ã€ã‚¦ã‚§ã‚¤ã‚¯ãƒ¯ãƒ¼ãƒ‰å­¦ç¿’ãƒ»æ¤œå‡ºãƒ»å¹¾ä½•å­¦æ¨¡æ§˜è¡¨ç¤ºã‚’çµ±åˆã—ãŸå®Œå…¨ãªUIåŸºç›¤ã‚’æ§‹ç¯‰  
**æˆæœ**: å…¨ã‚¨ãƒ©ãƒ¼è§£æ¶ˆã€å®Œå…¨å‹•ä½œç¢ºèªæ¸ˆã¿ã€ç¬¬ä¸‰è€…å¼•ãç¶™ãå¯èƒ½ãªçŠ¶æ…‹  
**è¨­è¨ˆåŸå‰‡**: å˜ä¸€è²¬ä»»åŸå‰‡ãƒ»ã‚·ãƒ³ãƒ—ãƒ«ãƒ»ãƒ¢ãƒ€ãƒ³ãƒ»æ‹¡å¼µæ€§é‡è¦–  

### **ğŸš€ å®Ÿè£…ã—ãŸæ©Ÿèƒ½**

#### **1. Journey Room UIåŸºç›¤**
**ãƒ•ã‚¡ã‚¤ãƒ«**: `apps/web/src/journey-room/JourneyRoom.jsx`

**æ©Ÿèƒ½**:
- **çµ±åˆUIç®¡ç†**: ã‚¦ã‚§ã‚¤ã‚¯ãƒ¯ãƒ¼ãƒ‰å­¦ç¿’ãƒ»å¹¾ä½•å­¦æ¨¡æ§˜ãƒ»éŸ³å£°çŠ¶æ…‹ã®çµ±åˆè¡¨ç¤º
- **å‹•çš„ã‚¤ãƒ³ãƒãƒ¼ãƒˆ**: GeometricVisualizerãƒ»WakeWordTrainerã®é…å»¶èª­ã¿è¾¼ã¿
- **AudioStateManagerçµ±åˆ**: ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ éŸ³å£°å‡¦ç†ã¨ã®é€£æº
- **ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰APIé€£æº**: è¨­å®šãƒ»çŠ¶æ…‹ãƒ»å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ã®åŒæœŸ
- **ãƒ‡ãƒãƒƒã‚°æƒ…å ±è¡¨ç¤º**: é–‹ç™ºãƒ»é‹ç”¨æ™‚ã®çŠ¶æ…‹ç›£è¦–

**æŠ€è¡“ä»•æ§˜**:
```javascript
// AudioStateManageråˆæœŸåŒ–ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ»è¨­å®šæƒ…å ±ã‚’æ¸¡ã™ï¼‰
if (audioStateManagerRef.current && user && settings) {
  await audioStateManagerRef.current.start(settings, user);
}

// APIå‘¼ã³å‡ºã—ï¼ˆå®Œå…¨URLä½¿ç”¨ï¼‰
const response = await fetch(`http://localhost:3001/api/journey-room/wake-word-status?userId=${user.id}`);
```

#### **2. ã‚¦ã‚§ã‚¤ã‚¯ãƒ¯ãƒ¼ãƒ‰å­¦ç¿’ã‚·ã‚¹ãƒ†ãƒ **
**ãƒ•ã‚¡ã‚¤ãƒ«**: `apps/web/src/journey-room/WakeWordTrainer.jsx`

**æ©Ÿèƒ½**:
- **3å›éŒ²éŸ³å­¦ç¿’**: Siriæ–¹å¼ã®ã€Œã‚¸ãƒ£ãƒ¼ãƒ‹ãƒ¼ã€ç™ºå£°å­¦ç¿’
- **ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼**: éŒ²éŸ³é€²æ—ã®è¦–è¦šçš„ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯
- **éŸ³å£°ç‰¹å¾´é‡æŠ½å‡º**: éŒ²éŸ³ãƒ‡ãƒ¼ã‚¿ã®å‰å‡¦ç†ãƒ»åˆ†æ
- **ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰é€ä¿¡**: å€‹åˆ¥éŒ²éŸ³ãƒ‡ãƒ¼ã‚¿ã®é †æ¬¡é€ä¿¡
- **çŠ¶æ…‹åŒæœŸ**: UIè¡¨ç¤ºã¨å®Ÿéš›ã®éŒ²éŸ³çŠ¶æ…‹ã®å®Œå…¨ä¸€è‡´

**ä¿®æ­£å†…å®¹**:
```javascript
// ä¿®æ­£å‰: è¤‡æ•°ãƒ•ã‚¡ã‚¤ãƒ«ä¸€æ‹¬é€ä¿¡ï¼ˆ400ã‚¨ãƒ©ãƒ¼ï¼‰
allRecordings.forEach((recording, index) => {
  formData.append(`recording_${index}`, recording.blob);
});
formData.append('user_id', user.id);

// ä¿®æ­£å¾Œ: å€‹åˆ¥é€ä¿¡ï¼ˆæ­£å¸¸å‹•ä½œï¼‰
for (let i = 0; i < allRecordings.length; i++) {
  const formData = new FormData();
  formData.append('audio', recording.blob, `journey_${i + 1}.webm`);
  formData.append('userId', user.id);
  // å€‹åˆ¥APIå‘¼ã³å‡ºã—
}
```

#### **3. å¹¾ä½•å­¦æ¨¡æ§˜è¦–è¦šè¡¨ç¾**
**ãƒ•ã‚¡ã‚¤ãƒ«**: `apps/web/src/journey-room/GeometricVisualizer.jsx`

**æ©Ÿèƒ½**:
- **å‹•çš„è¨­å®šèª­ã¿è¾¼ã¿**: ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‹ã‚‰å¹¾ä½•å­¦æ¨¡æ§˜è¨­å®šã‚’å–å¾—
- **ãƒ¢ãƒ¼ãƒ‰åˆ¥è¡¨ç¤º**: idleãƒ»listeningãƒ»processingãƒ»respondingçŠ¶æ…‹ã®è¦–è¦šåŒ–
- **æ•°å¼åˆ¶å¾¡**: ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰èª¿æ•´å¯èƒ½ãªæ•°å­¦çš„ãƒ‘ã‚¿ãƒ¼ãƒ³ç”Ÿæˆ
- **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°**: AudioStateManagerã‹ã‚‰ã®éŸ³å£°ãƒ‡ãƒ¼ã‚¿é€£æº

**è¨­å®šä¾‹**:
```json
{
  "idle": {
    "formula": "sin(t * 2) * cos(t * 3)",
    "color": "#4A90E2",
    "speed": 1.0,
    "amplitude": 0.3
  }
}
```

#### **4. AudioStateManageréŸ³å£°å‡¦ç†åŸºç›¤**
**ãƒ•ã‚¡ã‚¤ãƒ«**: `apps/web/src/journey-room/AudioStateManager.js`

**æ©Ÿèƒ½**:
- **ã‚¦ã‚§ã‚¤ã‚¯ãƒ¯ãƒ¼ãƒ‰æ¤œå‡º**: å­¦ç¿’æ¸ˆã¿ãƒ¢ãƒ‡ãƒ«ã¨ã®éŸ³å£°ãƒãƒƒãƒãƒ³ã‚°
- **VADçµ±åˆ**: Phase2.5ã®VADProcessorã¨ã®é€£æº
- **WebSocketé€šä¿¡**: ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ STTã¨ã®æ¥ç¶š
- **çŠ¶æ…‹ç®¡ç†**: idleãƒ»listeningãƒ»processingãƒ»respondingãƒ¢ãƒ¼ãƒ‰ã®åˆ¶å¾¡
- **ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯å‡¦ç†**: UIæ›´æ–°ãƒ»å¹¾ä½•å­¦æ¨¡æ§˜åˆ¶å¾¡ã®ã‚¤ãƒ™ãƒ³ãƒˆé…ä¿¡

**åˆæœŸåŒ–ãƒ•ãƒ­ãƒ¼**:
```javascript
// 1. ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ»è¨­å®šæƒ…å ±ã‚’å—ã‘å–ã‚‹
async start(settings, user) {
  this.settings = settings;
  this.user = user;
  
  // 2. ã‚¦ã‚§ã‚¤ã‚¯ãƒ¯ãƒ¼ãƒ‰ãƒ¢ãƒ‡ãƒ«èª­ã¿è¾¼ã¿
  await this.loadWakeWordModel();
  
  // 3. WebSocketæ¥ç¶š
  await this.connectWebSocket();
  
  // 4. éŸ³å£°ã‚¹ãƒˆãƒªãƒ¼ãƒ é–‹å§‹
  await this.startAudioStream();
}
```

### **ğŸ› ï¸ ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰APIå®Ÿè£…**

#### **Journey Roomå°‚ç”¨APIãƒ«ãƒ¼ã‚¿ãƒ¼**
**ãƒ•ã‚¡ã‚¤ãƒ«**: `backend/routes/journeyRoom.js`

**å®Ÿè£…ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ**:

1. **ã‚¦ã‚§ã‚¤ã‚¯ãƒ¯ãƒ¼ãƒ‰å­¦ç¿’çŠ¶æ…‹å–å¾—**
   ```
   GET /api/journey-room/wake-word-status?userId={userId}
   ```
   - å­¦ç¿’é€²æ—ãƒ»å®Œäº†çŠ¶æ…‹ãƒ»æœ€çµ‚å­¦ç¿’æ—¥æ™‚ã‚’è¿”å´
   - Supabase `wake_word_training` ãƒ†ãƒ¼ãƒ–ãƒ«ã¨ã®é€£æº

2. **ã‚¦ã‚§ã‚¤ã‚¯ãƒ¯ãƒ¼ãƒ‰å­¦ç¿’å‡¦ç†**
   ```
   POST /api/journey-room/train-wake-word
   ```
   - éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«å—ä¿¡ãƒ»éŸ³å£°ç‰¹å¾´é‡æŠ½å‡ºãƒ»ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ä¿å­˜
   - å€‹åˆ¥éŒ²éŸ³å¯¾å¿œï¼ˆ3å›ã®éŒ²éŸ³ã‚’é †æ¬¡å‡¦ç†ï¼‰

3. **ã‚¦ã‚§ã‚¤ã‚¯ãƒ¯ãƒ¼ãƒ‰ãƒ¢ãƒ‡ãƒ«å–å¾—**
   ```
   GET /api/journey-room/wake-word-model?userId={userId}
   ```
   - å­¦ç¿’æ¸ˆã¿ãƒ¢ãƒ‡ãƒ«ãƒ‡ãƒ¼ã‚¿ã®å–å¾—
   - æœªå­¦ç¿’æ™‚ã¯é©åˆ‡ãªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¿”å´

4. **å¹¾ä½•å­¦æ¨¡æ§˜è¨­å®šç®¡ç†**
   ```
   GET/POST /api/journey-room/geometric-config
   ```
   - æ•°å¼ãƒ»è‰²ãƒ»é€Ÿåº¦ç­‰ã®å‹•çš„è¨­å®š
   - JSONè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã¨ã®é€£æº

#### **Supabaseãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹çµ±åˆ**
**ãƒ•ã‚¡ã‚¤ãƒ«**: `backend/sql/wake_word_training.sql`

**ãƒ†ãƒ¼ãƒ–ãƒ«è¨­è¨ˆ**:
```sql
CREATE TABLE wake_word_training (
  id UUID DEFAULT gen_random_uuid() PRIMARY KEY,
  user_id UUID NOT NULL,
  audio_features JSONB NOT NULL,
  training_count INTEGER NOT NULL DEFAULT 0,
  is_trained BOOLEAN NOT NULL DEFAULT FALSE,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);
```

**RLSãƒãƒªã‚·ãƒ¼**:
- ãƒ¦ãƒ¼ã‚¶ãƒ¼è‡ªèº«ã®ãƒ‡ãƒ¼ã‚¿ã®ã¿ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½
- èªè¨¼æ¸ˆã¿ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã¿æ“ä½œè¨±å¯

### **ğŸ› è§£æ±ºã—ãŸãƒã‚°ãƒ»ã‚¨ãƒ©ãƒ¼**

#### **1. API 404ã‚¨ãƒ©ãƒ¼**
**åŸå› **: ç›¸å¯¾ãƒ‘ã‚¹ä½¿ç”¨ã«ã‚ˆã‚Šãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚µãƒ¼ãƒãƒ¼ã«ã‚¢ã‚¯ã‚»ã‚¹
```javascript
// å•é¡Œ: /api/journey-room/train-wake-word â†’ http://localhost:5173/api/...
// è§£æ±º: http://localhost:3001/api/journey-room/train-wake-word
```

#### **2. API 400 Bad Requestã‚¨ãƒ©ãƒ¼**
**åŸå› **: ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰APIã®æœŸå¾…ã™ã‚‹å½¢å¼ã¨ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰é€ä¿¡å½¢å¼ã®ä¸ä¸€è‡´
```javascript
// å•é¡Œ: è¤‡æ•°ãƒ•ã‚¡ã‚¤ãƒ«ä¸€æ‹¬é€ä¿¡ + ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰åä¸ä¸€è‡´
// è§£æ±º: å€‹åˆ¥é€ä¿¡ + æ­£ç¢ºãªãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰åï¼ˆuserId, audioï¼‰
```

#### **3. AudioStateManagerèµ·å‹•å¤±æ•—**
**åŸå› **: ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±æœªæ¸¡ã— â†’ `this.user.access_token` ãŒ undefined
```javascript
// å•é¡Œ: audioStateManager.start() ï¼ˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãªã—ï¼‰
// è§£æ±º: audioStateManager.start(settings, user)
```

#### **4. ã‚¦ã‚§ã‚¤ã‚¯ãƒ¯ãƒ¼ãƒ‰ãƒ¢ãƒ‡ãƒ«èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼**
**åŸå› **: APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆæœªå®Ÿè£… + ç›¸å¯¾ãƒ‘ã‚¹å•é¡Œ
```javascript
// å•é¡Œ: å­˜åœ¨ã—ãªã„ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ + HTMLãƒšãƒ¼ã‚¸å—ä¿¡ â†’ JSONè§£æã‚¨ãƒ©ãƒ¼
// è§£æ±º: ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆå®Ÿè£… + å®Œå…¨URLä½¿ç”¨
```

#### **5. CSSãƒ»ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆç«¶åˆ**
**åŸå› **: `height: 100vh` + `overflow: hidden` ã«ã‚ˆã‚‹å›ºå®šãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ
```css
/* å•é¡Œ: ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ä¸å¯ */
.journey-room { height: 100vh; overflow: hidden; }

/* è§£æ±º: ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«å¯èƒ½ */
.journey-room { min-height: 100vh; overflow-y: auto; }
```

### **ğŸ“Š å‹•ä½œç¢ºèªçµæœ**

#### **âœ… å®Œå…¨å‹•ä½œç¢ºèªæ¸ˆã¿æ©Ÿèƒ½**
1. **ã‚¦ã‚§ã‚¤ã‚¯ãƒ¯ãƒ¼ãƒ‰å­¦ç¿’**: 3å›éŒ²éŸ³ â†’ APIé€ä¿¡ â†’ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ä¿å­˜
2. **AudioStateManagerèµ·å‹•**: ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼ â†’ ãƒ¢ãƒ‡ãƒ«èª­ã¿è¾¼ã¿ â†’ WebSocketæ¥ç¶š
3. **å¹¾ä½•å­¦æ¨¡æ§˜è¡¨ç¤º**: ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰è¨­å®šèª­ã¿è¾¼ã¿ â†’ å‹•çš„è¡¨ç¤º
4. **UIçŠ¶æ…‹åŒæœŸ**: éŒ²éŸ³é€²æ—ãƒ»å­¦ç¿’çŠ¶æ…‹ãƒ»ã‚¨ãƒ©ãƒ¼è¡¨ç¤ºã®å®Œå…¨ä¸€è‡´
5. **APIé€£æº**: å…¨ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆæ­£å¸¸å‹•ä½œãƒ»ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

#### **ğŸ”§ è¨­å®šãƒ»ç’°å¢ƒè¦ä»¶**
- **ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚µãƒ¼ãƒãƒ¼**: `http://localhost:3001`
- **ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚µãƒ¼ãƒãƒ¼**: `http://localhost:5173`
- **Supabase**: `wake_word_training` ãƒ†ãƒ¼ãƒ–ãƒ«ä½œæˆæ¸ˆã¿
- **ç’°å¢ƒå¤‰æ•°**: OpenAIãƒ»Gemini APIã‚­ãƒ¼è¨­å®šæ¸ˆã¿

### **ğŸ¯ ç¬¬ä¸‰è€…å¼•ãç¶™ããƒã‚¤ãƒ³ãƒˆ**

#### **é‡è¦ãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§**
```
# ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰
apps/web/src/journey-room/
â”œâ”€â”€ JourneyRoom.jsx          # ãƒ¡ã‚¤ãƒ³UIçµ±åˆ
â”œâ”€â”€ WakeWordTrainer.jsx      # ã‚¦ã‚§ã‚¤ã‚¯ãƒ¯ãƒ¼ãƒ‰å­¦ç¿’
â”œâ”€â”€ GeometricVisualizer.jsx  # å¹¾ä½•å­¦æ¨¡æ§˜è¡¨ç¤º
â”œâ”€â”€ AudioStateManager.js    # éŸ³å£°å‡¦ç†åŸºç›¤
â””â”€â”€ JourneyRoom.css         # ã‚¹ã‚¿ã‚¤ãƒ«å®šç¾©

# ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰
backend/
â”œâ”€â”€ routes/journeyRoom.js    # APIå®Ÿè£…
â”œâ”€â”€ sql/wake_word_training.sql # DBè¨­è¨ˆ
â””â”€â”€ config/geometric-config.json # å¹¾ä½•å­¦è¨­å®š
```

#### **ãƒ‡ãƒãƒƒã‚°æ‰‹é †**
1. **ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰èµ·å‹•ç¢ºèª**: `http://localhost:3001/health`
2. **APIç–é€šç¢ºèª**: Postmanã§å„ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆãƒ†ã‚¹ãƒˆ
3. **Supabaseãƒ†ãƒ¼ãƒ–ãƒ«ç¢ºèª**: `wake_word_training` ã®å­˜åœ¨ãƒ»RLSè¨­å®š
4. **ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚³ãƒ³ã‚½ãƒ¼ãƒ«**: ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ãƒ»APIå‘¼ã³å‡ºã—çŠ¶æ³
5. **ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¿ãƒ–**: API ãƒ¬ã‚¹ãƒãƒ³ã‚¹å†…å®¹ãƒ»ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰

#### **ã‚ˆãã‚ã‚‹å•é¡Œãƒ»è§£æ±ºæ–¹æ³•**
- **404ã‚¨ãƒ©ãƒ¼**: ç›¸å¯¾ãƒ‘ã‚¹ â†’ å®Œå…¨URLä¿®æ­£
- **400ã‚¨ãƒ©ãƒ¼**: ãƒªã‚¯ã‚¨ã‚¹ãƒˆå½¢å¼ç¢ºèªãƒ»ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰åä¸€è‡´
- **èªè¨¼ã‚¨ãƒ©ãƒ¼**: ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ãƒ»access_tokenç¢ºèª
- **CSSç«¶åˆ**: ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ã‚¹ã‚¿ã‚¤ãƒ«å‰Šé™¤ãƒ»CSSã‚¯ãƒ©ã‚¹å„ªå…ˆ
- **çŠ¶æ…‹ä¸æ•´åˆ**: useEffectä¾å­˜é…åˆ—ãƒ»çŠ¶æ…‹æ›´æ–°ã‚¿ã‚¤ãƒŸãƒ³ã‚°ç¢ºèª

### **ğŸš€ æ¬¡ãƒ•ã‚§ãƒ¼ã‚ºï¼ˆPhase3ï¼‰ã¸ã®æº–å‚™**

#### **å®Œäº†æ¸ˆã¿åŸºç›¤**
âœ… **Journey Room UI**: å®Œå…¨çµ±åˆãƒ»å‹•ä½œç¢ºèªæ¸ˆã¿  
âœ… **ã‚¦ã‚§ã‚¤ã‚¯ãƒ¯ãƒ¼ãƒ‰å­¦ç¿’**: 3å›éŒ²éŸ³ â†’ APIé€ä¿¡ â†’ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ä¿å­˜  
âœ… **AudioStateManager**: éŸ³å£°å‡¦ç†ãƒ»çŠ¶æ…‹ç®¡ç†åŸºç›¤  
âœ… **ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰API**: å…¨ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆå®Ÿè£…ãƒ»ãƒ†ã‚¹ãƒˆæ¸ˆã¿  
âœ… **ã‚¨ãƒ©ãƒ¼è§£æ¶ˆ**: å…¨æ—¢çŸ¥ãƒã‚°ä¿®æ­£ãƒ»å®‰å®šå‹•ä½œ  

#### **Phase3å®Ÿè£…äºˆå®š**
1. **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã‚¦ã‚§ã‚¤ã‚¯ãƒ¯ãƒ¼ãƒ‰æ¤œå‡º**
   - å­¦ç¿’æ¸ˆã¿ãƒ¢ãƒ‡ãƒ«ã¨ã®éŸ³å£°ãƒãƒƒãƒãƒ³ã‚°
   - ã€Œã‚¸ãƒ£ãƒ¼ãƒ‹ãƒ¼ã€ç™ºå£°ã§ã®è‡ªå‹•èµ·å‹•
   - é¡ä¼¼åº¦åˆ¤å®šã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ å®Ÿè£…

2. **éŸ³å£°ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆæ©Ÿèƒ½**
   - ã‚¦ã‚§ã‚¤ã‚¯ãƒ¯ãƒ¼ãƒ‰æ¤œå‡º â†’ åŒæœŸå‡¦ç†ãƒ¢ãƒ¼ãƒ‰
   - éŸ³å£°ã‚³ãƒãƒ³ãƒ‰èªè­˜ãƒ»å®Ÿè¡Œ
   - TTSå¿œç­”ãƒ»å¯¾è©±ãƒ•ãƒ­ãƒ¼

3. **å¹¾ä½•å­¦æ¨¡æ§˜ã®é«˜åº¦åŒ–**
   - ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ éŸ³å£°ãƒ‡ãƒ¼ã‚¿é€£å‹•
   - æ„Ÿæƒ…ãƒ»æ„å›³ã«å¿œã˜ãŸè¦–è¦šè¡¨ç¾
   - ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºæ©Ÿèƒ½

#### **æŠ€è¡“çš„æº–å‚™çŠ¶æ³**
- **VADProcessor**: Phase2.5ã§å®Ÿè£…æ¸ˆã¿
- **STTå¤šãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼**: OpenAIãƒ»Geminiå¯¾å¿œæ¸ˆã¿
- **WebSocketåŸºç›¤**: ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€šä¿¡æº–å‚™å®Œäº†
- **UIåŸºç›¤**: Journey Roomçµ±åˆå®Œäº†
- **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ‡ãƒ¼ã‚¿ç®¡ç†åŸºç›¤å®Œæˆ

**Phase2.5+ã®å …å®ŸãªåŸºç›¤ã«ã‚ˆã‚Šã€Phase3ã®ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã‚¦ã‚§ã‚¤ã‚¯ãƒ¯ãƒ¼ãƒ‰æ¤œå‡ºãƒ»éŸ³å£°ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆæ©Ÿèƒ½ã®å®Ÿè£…æº–å‚™ãŒå®Œå…¨ã«æ•´ã„ã¾ã—ãŸã€‚**
